<div *ngIf="textos" class="rcss-main">
    <div class="filtro" fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="58px">
        <span class="filtrado-por">{{textos.admin_usuarios.tabla_usuarios.filtrar_por}}</span>
        <div class="box">
            <form [formGroup]="formFiltro">
                <mat-form-field appearance="outline">
                    <input class="campo-buscar-texto" formControlName="buscarNombre" matInput placeholder="{{textos.admin_usuarios.tabla_usuarios.nombres}}" (ngModelChange)="onNameChange($event)">
                    <mat-icon class="icono-select">
                        account_circle
                    </mat-icon>
                </mat-form-field>

                <mat-form-field appearance="outline">
                    <mat-select formControlName="idPais">
                        <input class="campo-buscar" [formControl]="buscarPais" matInput placeholder="Buscar" (valueChange)="bPais.value = ''" #bPais value="">
                        <mat-option [value]="0" style="color: #001737 !important;">
                            {{textos.admin_usuarios.tabla_usuarios.pais}}
                        </mat-option>
                        <mat-option #option [ngClass]="{'ocultar': !mostrar(buscarPais.value, item.nombre),'option-selected' : option._getAriaSelected()}" [value]="item.id" *ngFor="let item of paisesList">
                            {{item.nombre}}
                        </mat-option>
                    </mat-select>
                    <mat-icon class="icono-select">
                        expand_more
                    </mat-icon>
                </mat-form-field>
                <mat-form-field appearance="outline">
                    <mat-select formControlName="idRol">
                        <input class="campo-buscar" [formControl]="buscarRol" matInput placeholder="Buscar" (valueChange)="bRol.value = ''" #bRol value="">
                        <mat-option [value]="0" style="color: #001737 !important;">
                            {{textos.admin_usuarios.tabla_usuarios.rol_asignado}}
                        </mat-option>
                        <mat-option #options [ngClass]="{'ocultar': !mostrar(buscarRol.value, item.name),'option-selected' : options._getAriaSelected()}" [value]="item.id" *ngFor="let item of roles">
                            {{item.name}}
                        </mat-option>
                    </mat-select>
                    <mat-icon class="icono-select">
                        expand_more
                    </mat-icon>
                </mat-form-field>
            </form>
        </div>
    </div>
    <br><br>
    <div class="table-header" fxLayout="row" fxLayoutAlign="start center">
        <div class="item-header" fxFlex="15">{{textos.admin_usuarios.tabla_usuarios.email}}</div>
        <div class="item-header" fxFlex="15">{{textos.admin_usuarios.tabla_usuarios.nombres}}</div>
        <div class="item-header" fxFlex="15">{{textos.admin_usuarios.tabla_usuarios.apellidos}}</div>
        <div class="item-header centrado" fxFlex="10">{{textos.admin_usuarios.tabla_usuarios.invitacion}}</div>
        <div class="item-header centrado" fxFlex="8">{{textos.admin_usuarios.tabla_usuarios.registro}}</div>
        <div class="item-header centrado" fxFlex="8">{{textos.admin_usuarios.tabla_usuarios.estado}}</div>
        <div class="item-header" fxFlex="15">{{textos.admin_usuarios.tabla_usuarios.rol_asignado}}</div>
        <div class="item-header centrado" fxFlex="10">{{textos.admin_usuarios.tabla_usuarios.expiracion}}</div>
        <div class="item-header centrado" fxFlex="5">{{textos.admin_usuarios.tabla_roles.acciones}}</div>
    </div>
    <div class="table-content">
        <div fxLayout="row" class="fila-content" fxLayoutAlign="start center" *ngFor="let usuario of usuarios | paginate : configPaginador">
            <div class="item-content" fxFlex="15">
                <span class="texto-largo">
                    {{usuario.email}}
                </span>
            </div>
            <div class="item-content" fxFlex="15">{{usuario.name}}</div>
            <div class="item-content" fxFlex="15">{{usuario.last_name}}</div>
            <div class="item-content centrado" fxFlex="10">
                <button class="boton btn-enviado" [ngClass]="{'btn-enviado' : usuario.invitation_status === 'E','btn-enviar' : usuario.invitation_status !== 'E'}" (click)="openDialogInvitacion(usuario)">{{getLabelBtn(usuario.invitation_status)}}</button>
            </div>
            <div class="item-content centrado" fxFlex="8">
                <div [ngClass]="{'registrado': usuario.approved,'no-registrado': !usuario.approved}"></div>
            </div>
            <div class="item-content centrado" fxFlex="8">
                <div>
                    <label class="switch">
                        <input type="checkbox" (change)="cambiarEstado(usuario)" [value]="usuario.state ==='A' ? true : false" [checked]="usuario.state ==='A' ? true : false">
                        <span class="slider round"></span>
                    </label>
                    <span [ngClass]="{'activo' : usuario.state ==='A', 'inactivo' : usuario.state ==='I'}">
                        {{usuario.state ==='A' ? textos.admin_usuarios.activo : textos.admin_usuarios.inactivo}}
                    </span>
                </div>
            </div>
            <div class="item-content" fxFlex="10">{{usuario.rol.name}}</div>
            <div class="item-content centrado" fxFlex>{{usuario.invitation_sent | date : "dd/MM/yyyy"}}</div>
            <div class="item-content centrado" fxFlex="5">
                <button class="butt" style="float: left; border:none" (click)="openDialogEditUser(usuario)">
                  <mat-icon class="iconoEditar" svgIcon="iconoEditar"></mat-icon>
                </button>
              </div>
        </div>
    
    
    </div>
    <div fxLayout="row">
        <div fxFlex="15" fxLayout="row" fxLayoutAlign="start end">
            <a class="nuevo-registro" (click)="openDialogCrear()" fxFlex>
                <svg-icon key="iconoMas"></svg-icon>
                {{textos.generales.agregar_item}}
            </a>
        </div>
        <div fxFlex>
            <div fxLayout="row" fxLayoutAlign="end">
                <pagination-template #p="paginationApi" [id]="configPaginador.id" (pageChange)="pageChanged($event)">
                    <div class="custom-pagination" fxLayout="row">
                        <div *ngIf="!p.isFirstPage()" class="pagination-previous" [class.disabled]="p.isFirstPage()" (click)="p.previous()">
                            <span> 
                            <mat-icon class="flecha">
                                keyboard_arrow_left
                            </mat-icon>
                            </span>
                        </div>
                        <div class="page-number" (click)="p.setCurrent(page.value)" *ngFor="let page of p.pages" [class.current]="p.getCurrent() === page.value">
                            <span *ngIf="p.getCurrent() !== page.value">{{ page.label }}</span>
                            <div *ngIf="p.getCurrent() === page.value">
                                <span>{{ page.label }}</span>
                            </div>
                        </div>
                        <div *ngIf="!p.isLastPage()" class="pagination-next" [class.disabled]="p.isLastPage()" (click)="p.next()">
                            <span *ngIf="!p.isLastPage()" (click)="p.next()"> 
                            <mat-icon class="flecha">
                                keyboard_arrow_right
                            </mat-icon>
                            </span>
                        </div>
                    </div>
                </pagination-template>
            </div>
        </div>
    </div>
    
    <div class="contenedor-mensaje" *ngIf="mostrarConfirmacion">
        <div class="mensaje-confirmacion" fxLayout="row">
            <div fxFlex="10">
                <mat-icon class="icono-ok">
                    check
                </mat-icon>
            </div>
            <div fxFlex>
                <p class="texto-ok">
                    {{textos.admin_usuarios.tabla_usuarios.texto_ok_1}} <span>{{correoUsuario}}</span> {{textos.admin_usuarios.tabla_usuarios.texto_ok_2}}
                </p>
            </div>
        </div>
    </div>
</div>